<h3 class="page-header">
    <b>New Promotion</b>
</h3>
<form name="PromotionCreateForm" ng-submit="promotionCreate.Submit()" novalidate>
    <div class="row">
        <div class="form-group col-sm-6">
            <label for="promotionIDInput">ID</label>
            <input id="promotionIDInput" ordercloud-auto-id type="text" pattern="([A-Za-z0-9\-\_]+)" pattern-err-type="ID_Name" class="form-control" ng-model="promotionCreate.promotion.ID"/>
        </div>
        <div class="form-group col-sm-6">
            <label for="promotionNameInput">Promotion Name</label>
            <input id="promotionNameInput" type="text" class="form-control" ng-model="promotionCreate.promotion.Name"/>
        </div>
    </div>
    <div class="row">
        <div class="form-group col-sm-6">
            <label for="promotionCodeInput">Promotion Code</label>
            <input id="promotionCodeInput" type="text" class="form-control" ng-model="promotionCreate.promotion.Code" required="true"/>
        </div>
        <div class="form-group col-sm-6">
            <label for="promotionUsagesRemainingInput">Promotion Usages Remaining</label>
            <input id="promotionUsagesRemainingInput" type="number" class="form-control" ng-model="promotionCreate.promotion.UsagesRemaining"/>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6 form-group">
            <label for="promotionDescriptionInput">Description</label>
            <textarea id="promotionDescriptionInput" type="text" class="form-control" ng-model="promotionCreate.promotion.Description"></textarea>
        </div>
        <div class="col-sm-6 form-group">
            <label for="promotionFinePrintInput">Fine Print</label>
            <textarea id="promotionFinePrintInput" type="text" class="form-control" ng-model="promotionCreate.promotion.FinePrint"></textarea>
        </div>
    </div>
    <div class="row">
        <div class="form-group col-sm-6">
            <label for="promotionStartDateInput">Start Date</label>
            <input class="form-control" ng-show="application.isTouchDevice" type="date" id="promotionStartDateInput2" ng-model="promotionCreate.promotion.StartDate"/>
            <input id="promotionStartDateInput" ng-hide="application.isTouchDevice" type="text" ng-click="open1 = !open1" is-open="open1" uib-datepicker-popup="MM/dd/yyyy" datepicker-append-to-body="true" class="form-control" ng-model="promotionCreate.promotion.StartDate">
        </div>
        <div class="form-group col-sm-6">
            <label for="promotionEndDateInput">End Date</label>
            <input class="form-control" ng-show="application.isTouchDevice" type="date" id="promotionEndDateInput2" ng-model="promotionCreate.promotion.ExpirationDate"/>
            <input id="promotionEndDateInput" ng-hide="application.isTouchDevice" type="text" ng-click="open2 = !open2" is-open="open2" uib-datepicker-popup="MM/dd/yyyy" datepicker-append-to-body="true" class="form-control" ng-model="promotionCreate.promotion.EndDate">
        </div>
    </div>
    <div class="form-group">
        <label for="promotionCanCombineInput">
            <input id="promotionCanCombineInput" type="checkbox" ng-model="promotionCreate.promotion.CanCombine"/>
            Can Combine
        </label>
    </div>
    <div class="form-group">
        <label for="promotionEligibleExpressionInput">Eligible Expression</label>
        <div class="input-group">
            <input id="promotionEligibleExpressionInput" type="text" class="form-control" ng-model="promotionCreate.promotion.EligibleExpression" readonly required="true"/>
            <div class="input-group-btn">
                <button type="button" class="btn btn-info" ng-if="!promotionCreate.eligibleConditions.length" ng-click="promotionCreate.addEligibleCondition()"><i class="fa fa-plus"></i> Add Condition</button>
                <button type="button" class="btn btn-info dropdown-toggle" ng-if="promotionCreate.eligibleConditions.length" data-toggle="dropdown"><i class="fa fa-plus"></i> Add Condition <i class="fa fa-caret-down"></i></button>
                <ul class="dropdown-menu">
                    <li><a href="#" ng-click="promotionCreate.addEligibleCondition('or')">Or</a></li>
                    <li><a href="#" ng-click="promotionCreate.addEligibleCondition('and')">And</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row rule-condition" ng-repeat="condition in promotionCreate.eligibleConditions">
        <div ng-if="condition.LogicalOperator">
            <div class="form-group col-sm-2">
                <select class="form-control" ng-model="condition.Value" ng-options="logicalOperator as logicalOperator for logicalOperator in ['or', 'and']"></select>
            </div>
        </div>
        <div ng-if="!condition.LogicalOperator">
            <div class="form-group col-sm-2">
                <label for="eligibleConditionObject{{$index}}">Object</label>
                <select id="eligibleConditionObject{{$index}}" class="form-control" ng-model="condition.Object" ng-options="object as object.Name for object in promotionCreate.expressionObjects"></select>
            </div>
            <div class="form-group col-sm-2">
                <label for="eligibleConditionProperty{{$index}}">Property</label>
                <select id="eligibleConditionProperty{{$index}}" class="form-control" ng-model="condition.Property" ng-options="property as property.Name for property in condition.Object.Properties"></select>
            </div>
            <div class="form-group col-sm-2" ng-if="condition.Property.Value == 'xp'">
                <label for="eligibleConditionXPProperty{{$index}}">XP Property</label>
                <input id="eligibleConditionXPProperty{{$index}}" class="form-control" ng-model="condition.XPProperty" />
            </div>
            <div class="form-group col-sm-2">
                <label for="eligibleConditionOperator{{$index}}">Operator</label>
                <select id="eligibleConditionOperator{{$index}}" class="form-control" ng-model="condition.Operator" ng-options="operator as operator.Name for operator in condition.Property.Operators"></select>
            </div>
            <div class="form-group col-sm-2">
                <label for="eligibleConditionValue{{$index}}">Value</label>
                <input id="eligibleConditionValue{{$index}}" type="text" class="form-control" ng-model="condition.Value" />
            </div>
            <div class="col-sm-2" ng-if="!condition.LogicalOperator && $index">
                <button type="button" class="btn btn-danger" ng-click="promotionCreate.removeEligibleCondition($index)">Remove</button>
            </div>
        </div>
    </div>
    <div class="form-group">
        <label for="promotionValueExpressionInput">Value Expression</label>
        <div class="input-group">
            <input id="promotionValueExpressionInput" type="text" class="form-control" ng-model="promotionCreate.promotion.ValueExpression" readonly required="true"/>
            <div class="input-group-btn">
                <button type="button" class="btn btn-info"><i class="fa fa-plus"></i> Add Condition</button>
            </div>
        </div>
        <div class="row">

        </div>
    </div>
    <div class="form-group">
        <button type="submit" class="btn btn-primary" ng-disabled="PromotionCreateForm.$invalid">Save</button>
        <button type="button" class="btn btn-default" ui-sref="^">Cancel</button>
    </div>
</form>